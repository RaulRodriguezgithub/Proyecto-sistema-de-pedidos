<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="~{fragments/head :: head}"></head>

<body>

	<div class="container py-5">
		<h2 class="text-center mb-4">Inicio de Sesión</h2>
		<div class="row justify-content-center">
			<div class="col-md-6">

				<form th:action="@{/auth/login}" method="post" class="needs-validation" novalidate>
					<input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">

					<div class="mb-3">
						<label for="username" class="form-label">Nombre de Usuario</label>
						<input type="text" class="form-control" id="username" name="username" required>
						<div class="invalid-feedback">Ingrese el nombre de Usuario.</div>
					</div>

					<div class="mb-3">
						<label for="password" class="form-label">Contraseña</label>
						<div class="input-group">
							<input th:classappend="${param.error} ? 'input-error' : ''" type="password"
								class="form-control" id="password" name="password" minlength="8" required>
							<span class="input-group-text" onclick="togglePassword()" style="cursor: pointer;">
								<i class="fa fa-eye" id="toggleicon"></i>
							</span>
						</div>
						<div class="invalid-feedback">La contraseña debe tener al menos 8 caracteres.</div>
					</div>

					<button class="btn btn-dark w-100" type="submit">Iniciar Sesión</button>
				</form>
				<div th:if="${param.error}" class="error-message">
				    Usuario o contraseña incorrectos
				</div>

			</div>
		</div>
	</div>



	<script>
		(() => {
			'use strict';
			const forms = document.querySelectorAll('.needs-validation');
			Array.from(forms).forEach(form => {
				form.addEventListener('submit', event => {
					if (!form.checkValidity()) {
						event.preventDefault();
						event.stopPropagation();
					}
					form.classList.add('was-validated');
				}, false);
			});
		})();
		function togglePassword() {
			const input = document.getElementById("password");
			const icon = document.getElementById("toggleicon");
			if (input.type === "password") {
				input.type = "text";
				icon.classList.remove("fa-eye");
				icon.classList.add("fa-eye-slash");
			} else {
				input.type = "password";
				icon.classList.remove("fa-eye-slash");
				icon.classList.add("fa-eye");
			}
		}
	</script>

</body>
<div th:replace="~{fragments/footer :: footer}"></div>
</html>